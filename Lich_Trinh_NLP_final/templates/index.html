<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Lá»‹ch thÃ´ng minh</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

    {% if due_reminders %}
        <div class="reminder-alert">
            ğŸš¨ **NHáº®C NHá» KHáº¨N Cáº¤P:**
            {% for r in due_reminders %}
                <p>Sá»± kiá»‡n: <strong>{{ r['name'] }}</strong> (Báº¯t Ä‘áº§u: {{ r['start'].split('T')[1][:5] }} | Nháº¯c lÃºc: {{ r['reminder_time'] }})</p>
            {% endfor %}
        </div>
        <hr>
    {% endif %}

    <h2>â• ThÃªm Sá»± Kiá»‡n qua AI</h2>

    <form action="/add" method="POST">
        <input type="text" name="event_text" placeholder="VÃ­ dá»¥: Há»p lÃºc 10h30 20/12/2025" style="width: 300px;">
        <button>ThÃªm</button>
    </form>

    <hr>

    <h2>ğŸ“… Xem Sá»± Kiá»‡n Theo NgÃ y</h2>

    <form method="POST">
        <input type="date" name="date" value="{{ selected_date }}">
        <button class="search-button">Xem</button>
    </form>

    <a href="{{ url_for('export_json') }}" class="export-button">ğŸ“¥ Xuáº¥t dá»¯ liá»‡u (.json)</a>

    {% if events %}
        <h3>ğŸ—“ï¸ Káº¿t quáº£ (NgÃ y {{ selected_date }}):</h3>
        <ul class="event-list">
            {% for e in events %}
                {% set start_dt = e['start'].split('T') %}
                {% set date_part = start_dt[0].split('-') %}
                {% set time_part = start_dt[1][:5] %}

                <li class="event-item">
                    <div class="event-info">
                        <span class="event-name">{{ e['name'] }}</span>
                        lÃºc <span class="event-time">{{ time_part }}</span>
                        <span class="event-date">| NgÃ y {{ date_part[2] }}/{{ date_part[1] }}/{{ date_part[0] }}</span>
                    </div>

                    <div class="event-actions">
                        <a href="/edit/{{ e['id'] }}?prev_date={{ selected_date }}" class="edit-link">Sá»­a</a>

                        <form action="/delete/{{ e['id'] }}" method="POST" style="display:inline;">
                            <input type="hidden" name="selected_date" value="{{ selected_date }}">
                            <button type="submit" class="delete-button" onclick="return confirm('Báº¡n cÃ³ cháº¯c cháº¯n muá»‘n xÃ³a sá»± kiá»‡n nÃ y?');">XÃ³a</button>
                        </form>
                    </div>
                </li>
            {% endfor %}
        </ul>
    {% elif selected_date %}
        <p>KhÃ´ng cÃ³ sá»± kiá»‡n nÃ o cho ngÃ y **{{ selected_date }}**.</p>
    {% endif %}
</body>
</html>